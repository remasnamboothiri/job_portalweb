{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Apply for {{ job.title }}</title>
  
  <link rel="stylesheet" href="{% static 'css/custom-bs.css' %}">
  <link rel="stylesheet" href="{% static 'css/jquery.fancybox.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/bootstrap-select.min.css' %}">
    
  <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/animate.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/quill.snow.css' %}">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  
  <style>
    .file-upload-area {
      border: 2px dashed #89c442;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      background: #f8fdf5;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .file-upload-area:hover {
      background: #f0fbea;
      border-color: #7ab839;
    }
    
    .file-upload-icon {
      font-size: 48px;
      color: #89c442;
      margin-bottom: 15px;
    }
    
    .file-upload-text {
      color: #6c757d;
      font-size: 14px;
      margin-bottom: 5px;
    }
    
    .file-upload-browse {
      color: #89c442;
      font-weight: 600;
      text-decoration: underline;
      cursor: pointer;
    }
    
    #id_resume {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }
    
    .form-card {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      margin: 30px 0;
    }
    
    .form-section-title {
      color: #333;
      margin-bottom: 20px;
      font-size: 1.5rem;
    }
    
    .form-label {
      font-weight: 600;
      color: #555;
      margin-bottom: 8px;
      display: block;
    }
    
    .btn-apply {
      background: #89c442;
      color: white;
      padding: 12px 30px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .btn-apply:hover {
      background: #7ab839;
      transform: translateY(-2px);
    }
    
    .job-info {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .footer {
      background: #343a40;
      color: white;
      padding: 40px 0 20px;
    }

    .footer a {
      color: #ccc;
      text-decoration: none;
    }

    .footer a:hover {
      color: white;
      text-decoration: underline;
    }
    

  </style>
</head>
<body>


  <div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div> <!-- .site-mobile-menu -->
    

    <!-- NAVBAR -->
    <header class="site-navbar mt-3">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="site-logo col-6"><a href="{% url 'home' %}">JobBoard</a></div>

          <nav class="mx-auto site-navigation">
            <ul class="site-menu js-clone-nav d-none d-xl-block ml-0 pl-0">
              <li><a href="{% url 'home' %}" class="nav-link">Home</a></li>
              <li><a href="{% url 'about' %}">About</a></li>
              <li class="has-children">
                <a href="#">Job Listings</a>
                <ul class="dropdown">
                  <li><a class="dropdown-item" href="{% url 'job_list' %}">Job Listings</a></li>
                  <li><a class="dropdown-item" href="{% url 'post_job' %}">Post a Job</a></li>
                </ul>
              </li>
              <li class="has-children">
                <a href="services.html">Pages</a>
                <ul class="dropdown">
                  
                  
                  <li><a href="{% url 'blog' %}">Blog</a></li>
                  
                  <li><a href="{% url 'testimonials' %}">Testimonials</a></li>
                  <li><a href="{% url 'faq' %}">FAQ</a></li>
                  
                </ul>
              </li>
              
              <li><a href="{% url 'contact' %}">Contact</a></li>
              <li class="d-lg-none"><a href="{% url 'post_job' %}"><span class="mr-2">+</span> Post a Job</a></li>
              <li class="d-lg-none"><a href="{% url 'login' %}">Log In</a></li>
            </ul>
          </nav>
          
          <div class="right-cta-menu text-right d-flex aligin-items-center col-6">
            <div class="ml-auto">
              <a href="{% url 'post_job' %}" class="btn btn-outline-white border-width-2 d-none d-lg-inline-block"><span class="mr-2 icon-add"></span>Post a Job</a>
              <a href="{% url 'login' %}" class="btn btn-primary border-width-2 d-none d-lg-inline-block"><span class="mr-2 icon-lock_outline"></span>Log In</a>
            </div>
            <a href="#" class="site-menu-toggle js-menu-toggle d-inline-block d-xl-none mt-lg-2 ml-3"><span class="icon-menu h3 m-0 p-0 mt-2"></span></a>
          </div>

        </div>
      </div>
    </header>

    <!-- HOME -->
    <section class="section-hero overlay inner-page bg-image" style="background-image: url('{% static 'images/hero_1.jpg' %}');" id="home-section">
      <div class="container">
        <div class="row">
          <div class="col-md-7">
            <h1 class="text-white font-weight-bold">Apply Job</h1>
            <div class="custom-breadcrumbs">
              <a href="{% url 'home' %}">Home</a> <span class="mx-2 slash">/</span>
              <span class="text-white"><strong>Apply Job</strong></span>
            </div>
          </div>
        </div>
      </div>
    </section>
 

    <!-- JOB APPLICATION FORM -->
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          
          <!-- Messages -->
          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              </div>
            {% endfor %}
          {% endif %}
          
          <!-- Job Information -->
          <div class="job-info">
            <h3>{{ job.title }}</h3>
            <p><strong>Company:</strong> {{ job.company }}</p>
            <p><strong>Location:</strong> {{ job.location }}</p>
            <p><strong>Department:</strong> {{ job.get_department_display }}</p>
            <p><strong>Employment Type:</strong> {{ job.get_employment_type_display }}</p>
          </div>

          <!-- Application Form -->
          <form method="post" enctype="multipart/form-data" id="application-form">
            {% csrf_token %}
            <input type="hidden" name="form_submitted" value="1">
            
            <div class="form-card">
              <h2 class="form-section-title">Submit Your Application</h2>
              
              <!-- Display form errors -->
              {% if form.errors %}
                <div class="alert alert-danger">
                  <strong>Please fix the following errors:</strong>
                  <ul>
                    {% for field in form %}
                      {% for error in field.errors %}
                        <li>{{ field.label }}: {{ error }}</li>
                      {% endfor %}
                    {% endfor %}
                  </ul>
                </div>
              {% endif %}
              
              <!-- Resume Upload -->
              <div class="form-group mb-4">
                <label class="form-label" for="id_resume">Upload Resume *</label>
                <div class="file-upload-container">
                  <div class="file-upload-area" id="file-upload-display">
                    <div class="file-upload-icon">ðŸ“„</div>
                    <div class="file-upload-text">
                      <strong>Click to upload your resume</strong><br>
                      <small>Supported formats: PDF, DOC, DOCX (Max 5MB)</small><br>
                      <span class="file-upload-browse">Browse File</span>
                    </div>
                  </div>
                  <input type="file" name="resume" id="id_resume" accept=".pdf,.doc,.docx" required class="form-control" style="position: absolute; opacity: 0; width: 100%; height: 100%; cursor: pointer; z-index: 1;">
                </div>
                {% if form.resume.errors %}
                  <div class="text-danger mt-2">
                    {% for error in form.resume.errors %}
                      <small>{{ error }}</small><br>
                    {% endfor %}
                  </div>
                {% endif %}
                <small class="text-muted">Please upload your most recent resume in PDF or Word format.</small>
              </div>

              <!-- Submit Button -->
              <div class="text-center">
                <button type="submit" class="btn-apply" id="submit-btn">
                  <i class="fas fa-paper-plane"></i> Submit Application
                </button>
                <br><br>
                <a href="{% url 'job_detail' job.id %}" class="btn btn-secondary">
                  <i class="fas fa-arrow-left"></i> Back to Job Details
                </a>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <h5>JobPortal</h5>
          <p>Your gateway to a better career. Find jobs, post openings, and grow your career or company.</p>
        </div>
        <div class="col-md-4">
          <h6>Quick Links</h6>
          <ul class="list-unstyled">
            <li><a href="{% url 'home' %}">Home</a></li>
            <li><a href="{% url 'job_list' %}">Jobs</a></li>
            <li><a href="{% url 'register' %}">Register</a></li>
            <li><a href="{% url 'login' %}">Login</a></li>
          </ul>
        </div>
        <div class="col-md-4">
          <h6>Contact</h6>
          <p>Email: support@jobportal.com</p>
          <p>Phone: +91-9876543210</p>
          <p>Kochi, Kerala</p>
        </div>
      </div>
      <div class="text-center pt-3 border-top">
        <p>&copy; 2025 JobPortal. All rights reserved.</p>
      </div>
    </div>
  </footer> 


    <!-- SCRIPTS -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/isotope.pkgd.min.js' %}"></script>
    <script src="{% static 'js/stickyfill.min.js' %}"></script>
    <script src="{% static 'js/jquery.fancybox.min.js' %}"></script>
    <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
    <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'js/jquery.animateNumber.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/quill.min.js' %}"></script>
    <script src="{% static 'js/bootstrap-select.min.js' %}"></script>
    <script src="{% static 'js/custom.js' %}"></script>

    <style>
      .file-upload-container {
        position: relative;
      }
      
      .file-upload-area {
        border: 2px dashed #ddd;
        border-radius: 8px;
        padding: 30px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        background: #f9f9f9;
      }
      
      .file-upload-area:hover {
        border-color: #007bff;
        background: #f0f8ff;
      }
      
      .file-upload-icon {
        font-size: 48px;
        margin-bottom: 15px;
        color: #666;
      }
      
      .file-upload-text {
        color: #666;
      }
      
      .file-upload-browse {
        color: #007bff;
        font-weight: 500;
      }
      
      .file-upload-container #id_resume {
        position: absolute;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
        z-index: 1;
        top: 0;
        left: 0;
      }
      
      .btn-apply {
        background: #007bff;
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        transition: background 0.3s ease;
      }
      
      .btn-apply:hover {
        background: #0056b3;
      }
      
      .job-info {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
      }
      
      .form-card {
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      
      .form-section-title {
        color: #333;
        margin-bottom: 25px;
        text-align: center;
      }
    </style>

    <script>
      // Resume file upload interaction
      document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.getElementById('id_resume');
        const fileUploadArea = document.getElementById('file-upload-display');
        const form = document.getElementById('application-form');
        
        // Make the display area clickable to trigger file input
        if (fileInput && fileUploadArea) {
          fileUploadArea.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            fileInput.click();
          });
          
          fileInput.addEventListener('change', function(e) {
            e.stopPropagation();
            if (this.files && this.files[0]) {
              const file = this.files[0];
              const fileName = file.name;
              const fileSize = (file.size / 1024 / 1024).toFixed(2); // Size in MB
              
              // Check file type
              const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
              const allowedExtensions = ['.pdf', '.doc', '.docx'];
              const fileExtension = fileName.toLowerCase().substring(fileName.lastIndexOf('.'));
              
              if (!allowedTypes.includes(file.type) && !allowedExtensions.includes(fileExtension)) {
                alert('Please upload a PDF, DOC, or DOCX file.');
                this.value = '';
                return;
              }
              
              // Check file size (5MB limit)
              if (file.size > 5 * 1024 * 1024) {
                alert('File size must be less than 5MB.');
                this.value = '';
                return;
              }
              
              // Update UI
              fileUploadArea.innerHTML = `
                <div class="file-upload-icon">âœ“</div>
                <div class="file-upload-text">
                  <strong>${fileName}</strong><br>
                  <small>Size: ${fileSize} MB</small><br>
                  <span class="file-upload-browse">Change file</span>
                </div>
              `;
              fileUploadArea.style.background = '#e8f5e8';
              fileUploadArea.style.borderColor = '#28a745';
            }
          });
        }
        
        // Handle form submission
        if (form) {
          form.addEventListener('submit', function(e) {
            const fileInput = document.getElementById('id_resume');
            const submitBtn = document.getElementById('submit-btn');
            
            // Check if file is selected
            if (!fileInput.files || fileInput.files.length === 0) {
              e.preventDefault();
              alert('Please select a resume file before submitting.');
              return false;
            }
            
            // Disable submit button to prevent double submission
            if (submitBtn) {
              submitBtn.disabled = true;
              submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            }
          });
        }
      });
    </script>
  
</body>
</html>





