{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Job Seeker Dashboard</title>

  
  
    <link rel="stylesheet" href="{% static 'css/custom-bs.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery.fancybox.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap-select.min.css' %}">
    
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/animate.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/quill.snow.css' %}">
    

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}"> 

  <!-- ✅ Inline CSS for background image -->
  <style>
    body {
      
      background-size: cover;
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }

    .card, .alert {
      background-color: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(4px);
      border-radius: 10px;
    }

    h2, .card-title {
      color: #333;
    }

      .footer {
      background: #343a40;
      color: white;
      padding: 40px 0 20px;
    }

    .footer a {
      color: #ccc;
      text-decoration: none;
    }

    .footer a:hover {
      color: white;
      text-decoration: underline;
    }
    
    /* Interview Ready Button Styling */
    .interview-ready-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }
    
    .interview-ready-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      color: white;
      text-decoration: none;
    }
    
    .interview-info {
      background: linear-gradient(135deg, #ebedeeff 0%, #eff8f9ff 100%);
      border: none;
      color: black;
    }
    

  </style>
</head>
<body id="top">
<div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div> <!-- .site-mobile-menu -->
    

    <!-- NAVBAR -->
    <header class="site-navbar mt-3">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="site-logo col-6"><a href="{% url 'home' %}">JobBoard</a></div>

          <nav class="mx-auto site-navigation">
            <ul class="site-menu js-clone-nav d-none d-xl-block ml-0 pl-0">
              <li><a href="{% url 'home' %}" class="nav-link">Home</a></li>
              <li><a href="{% url 'about' %}">About</a></li>
              <li class="has-children">
                <a href="#">Job Listings</a>
                <ul class="dropdown">
                  <li><a class="dropdown-item" href="{% url 'job_list' %}">Job Listings</a></li>
                  <li><a class="dropdown-item" href="{% url 'post_job' %}">Post a Job</a></li>
                </ul>
              </li>
              <li class="has-children">
                <a href="services.html">Pages</a>
                <ul class="dropdown">
                  
                  
                  <li><a href="{% url 'blog' %}">Blog</a></li>
                  
                  <li><a href="{% url 'testimonials' %}">Testimonials</a></li>
                  <li><a href="{% url 'faq' %}">FAQ</a></li>
                  
                </ul>
              </li>
              
              <li><a href="{% url 'contact' %}">Contact</a></li>
              <li class="d-lg-none"><a href="{% url 'post_job' %}"><span class="mr-2">+</span> Post a Job</a></li>
              <li class="d-lg-none"><a href="{% url 'login' %}">Log In</a></li>
            </ul>
          </nav>
          
          <div class="right-cta-menu text-right d-flex aligin-items-center col-6">
            <div class="ml-auto">
              <a href="{% url 'post_job' %}" class="btn btn-outline-white border-width-2 d-none d-lg-inline-block"><span class="mr-2 icon-add"></span>Post a Job</a>
              <a href="{% url 'login' %}" class="btn btn-primary border-width-2 d-none d-lg-inline-block"><span class="mr-2 icon-lock_outline"></span>Log In</a>
            </div>
            <a href="#" class="site-menu-toggle js-menu-toggle d-inline-block d-xl-none mt-lg-2 ml-3"><span class="icon-menu h3 m-0 p-0 mt-2"></span></a>
          </div>

        </div>
      </div>
    </header>


<!-- HOME -->
    <!-- HOME -->
    <section class="section-hero overlay inner-page bg-image" style="background-image: url('{% static 'images/hero_1.jpg' %}');" id="home-section">
      <div class="container">
        <div class="row">
          <div class="col-md-7">
            <h1 class="text-white font-weight-bold">{{ user.get_full_name|default:user.username }} | Dashboard</h1>
            <div class="custom-breadcrumbs">
              <a href="{% url 'home' %}">Home</a> <span class="mx-2 slash">/</span>
              <span class="text-white"><strong>Candidate Dashboard</strong></span>
            </div>
          </div>
        </div>
      </div>
    </section>


   
  
  <div class="container py-5">
    <div class="mb-4 text-center">
      <h2 class="text-Black">Hi {{ user.get_full_name|default:user.username }}, you're looking for the right job!</h2>
      <a href="{% url 'job_list' %}" class="btn btn-primary mt-3">
        Go to Job Listings
      </a>
    </div>

    {% if applications %}
      <div class="row g-4">
        <!-- Show Applications -->
        {% for app in applications %}
          <div class="col-12">
            <div class="card shadow-sm">
              <div class="card-body">
                <h5 class="card-title">{{ app.job.title }}</h5>
                <p class="card-text">
                  <strong>Company:</strong> {{ app.job.company }}<br>
                  <strong>Status:</strong> {{ app.status }}<br>
                  <strong>Applied:</strong> {{ app.applied_at|date:"M d, Y" }}
                </p>

                <!-- Check for scheduled interviews (with error handling) -->
                {% if scheduled_interviews %}
                  {% for interview in scheduled_interviews %}
                    {% if interview.job_position == app.job %}
                      <div class="alert interview-info mt-3">
                        <div class="row align-items-center">
                          <div class="col-md-8">
                            <h6 class="mb-2"><i class="fas fa-calendar-alt"></i> Interview Scheduled</h6>
                            <p class="mb-1">
                              <strong>Date:</strong> {{ interview.interview_date|date:"M d, Y" }} at {{ interview.interview_date|time:"H:i" }}
                            </p>
                            <p class="mb-1">
                              <strong>Position:</strong> {{ interview.job_position.title }}
                            </p>
                            <p class="mb-1">
                              <strong>Duration:</strong> 15 minutes | <strong>Questions:</strong> 8
                            </p>
                            <div class="interview-link-section mt-2">
                              <label class="small text-muted">Interview Link:</label>
                              <div class="input-group input-group-sm">
                                <input type="text" class="form-control" id="interview-link-{{ interview.id }}" value="{{ request.scheme }}://{{ request.get_host }}{% url 'interview_ready' interview.get_uuid %}" readonly>
                                <button class="btn btn-outline-secondary" type="button" onclick="copyInterviewLink('interview-link-{{ interview.id }}')">
                                  <i class="fas fa-copy"></i> Copy
                                </button>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-4 text-center">
                            <div class="d-grid gap-2">
                              <a href="{% url 'interview_ready' interview.get_uuid %}" class="interview-ready-btn">
                                <i class="fas fa-video"></i> Start Interview
                              </a>
                              <small class="text-muted">Click to begin your AI interview</small>
                            </div>
                          </div>
                        </div>
                      </div>
                    {% endif %}
                  {% endfor %}
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
        
        <!-- Show standalone interviews (with error handling) -->
        {% if scheduled_interviews %}
          {% for interview in scheduled_interviews %}
            {% with has_application=False %}
              {% for app in applications %}
                {% if app.job == interview.job_position %}
                  {% with has_application=True %}
                  {% endwith %}
                {% endif %}
              {% endfor %}
              {% if not has_application %}
                <div class="col-12">
                  <div class="card shadow-sm">
                    <div class="card-body">
                      <h5 class="card-title">{{ interview.job_position.title }}</h5>
                      <p class="card-text">
                        <strong>Company:</strong> {{ interview.job_position.company }}<br>
                        <strong>Status:</strong> Interview Scheduled
                      </p>
                      
                      <div class="alert interview-info mt-3">
                        <div class="row align-items-center">
                          <div class="col-md-8">
                            <h6 class="mb-2"><i class="fas fa-calendar-alt"></i> Interview Scheduled</h6>
                            <p class="mb-1">
                              <strong>Date:</strong> {{ interview.interview_date|date:"M d, Y" }} at {{ interview.interview_date|time:"H:i" }}
                            </p>
                            <p class="mb-1">
                              <strong>Position:</strong> {{ interview.job_position.title }}
                            </p>
                            <p class="mb-1">
                              <strong>Duration:</strong> 15 minutes | <strong>Questions:</strong> 8
                            </p>
                            <div class="interview-link-section mt-2">
                              <label class="small text-muted">Interview Link:</label>
                              <div class="input-group input-group-sm">
                                <input type="text" class="form-control" id="interview-link-standalone-{{ interview.id }}" value="{{ request.scheme }}://{{ request.get_host }}{% url 'interview_ready' interview.get_uuid %}" readonly>
                                <button class="btn btn-outline-secondary" type="button" onclick="copyInterviewLink('interview-link-standalone-{{ interview.id }}')">
                                  <i class="fas fa-copy"></i> Copy
                                </button>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-4 text-center">
                            <div class="d-grid gap-2">
                              <a href="{% url 'interview_ready' interview.get_uuid %}" class="interview-ready-btn">
                                <i class="fas fa-video"></i> Start Interview
                              </a>
                              <small class="text-muted">Click to begin your AI interview</small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}
            {% endwith %}
          {% endfor %}
        {% endif %}
      </div>
    {% else %}
      <div class="alert alert-warning text-center">
        <p>You haven't applied to any jobs yet.</p>
        {% if scheduled_interviews %}
          <p>However, you have scheduled interviews. Check below for interview details.</p>
        {% endif %}
      </div>
    {% endif %}
  </div>

  <!-- ✅ Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <h5>JobPortal</h5>
          <p>Your gateway to a better career. Find jobs, post openings, and grow your career or company.</p>
        </div>
        <div class="col-md-4">
          <h6>Quick Links</h6>
          <ul class="list-unstyled">
            <li><a href="{% url 'home' %}">Home</a></li>
            <li><a href="{% url 'job_list' %}">Jobs</a></li>
            <li><a href="{% url 'register' %}">Register</a></li>
            <li><a href="{% url 'login' %}">Login</a></li>
          </ul>
        </div>
        <div class="col-md-4">
          <h6>Contact</h6>
          <p>Email: support@jobportal.com</p>
          <p>Phone: +91-9876543210</p>
          <p>Kochi, Kerala</p>
        </div>
      </div>
      <div class="text-center pt-3 border-top">
        <p>&copy; 2025 JobPortal. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Font Awesome -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
  
  <!-- Copy Link Script -->
  <script>
    function copyInterviewLink(inputId) {
      const input = document.getElementById(inputId);
      input.select();
      input.setSelectionRange(0, 99999); // For mobile devices
      
      try {
        document.execCommand('copy');
        // Show success feedback
        const button = input.nextElementSibling;
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check"></i> Copied!';
        button.classList.remove('btn-outline-secondary');
        button.classList.add('btn-success');
        
        setTimeout(() => {
          button.innerHTML = originalText;
          button.classList.remove('btn-success');
          button.classList.add('btn-outline-secondary');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy: ', err);
        alert('Failed to copy link. Please copy manually.');
      }
    }
  </script>

      <!-- SCRIPTS -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/isotope.pkgd.min.js' %}"></script>
    <script src="{% static 'js/stickyfill.min.js' %}"></script>
    <script src="{% static 'js/jquery.fancybox.min.js' %}"></script>
    <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
    
    <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'js/jquery.animateNumber.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/quill.min.js' %}"></script>
    
    
    <script src="{% static 'js/bootstrap-select.min.js' %}"></script>
    
    <script src="{% static 'js/custom.js' %}"></script>
   
</body>
</html>